jQuery(document).ready((function(e){var t=t||{};t.admin={init(){this.toggle_child_input(),this.select_image(),this.settings_page(),this.submit_disabled_fields(),this.ajax_get_children_list()},toggle_child_input(){e(".ld_achievements_metabox_settings").length>0&&(e('select[name="trigger"]').change((function(){t.admin.update_select_values();const i=e(this).val();""!==i&&(e(".sfwd_input."+i).show(),e(".sfwd_input.child-input").not("."+i).hide(),e(".sfwd_input.hide_on_"+i).hide())})),e(window).load((function(){t.admin.update_select_values_onload();const i=e('select[name="trigger"]').val();""!==i&&(e(".sfwd_input."+i).show(),e(".sfwd_input.child-input").not("."+i).hide(),e(".sfwd_input.hide-empty-select").hide())})))},select_image(){const t=e("#image-field");if(0===t.length)return;const i=e("#image-preview-holder"),n=e("#image-preview-holder img"),o=e(".image-selector-buttons"),s=e(".icon-selection");let a;e(document).on("click",".select-image-btn",(function(e){e.preventDefault(),s.toggle()})),e(window).load((function(){const s=e("#image-field").val(),a=e('img.radio-btn[src="'+s+'"]');0===s.length&&a.length>0?(a.addClass("selected"),e(".icon-selection").show()):s.length>0&&(o.hide(),t.val(s),n.attr("src",s),i.show())})),e(document).on("click",".icon-selection .radio-btn",(function(t){t.preventDefault(),e(".icon-selection input[type=radio]").removeAttr("checked"),e(".icon-selection .radio-btn").removeClass("selected"),e(this).prev().attr("checked","checked"),e(this).addClass("selected"),e("#image-field").val(e(this).attr("src"))})),e(document).on("click","#upload-image",(function(l){l.preventDefault(),a||(a=wp.media.frames.file_frame=wp.media({title:"Choose Image",button:{text:"Choose Image"},multiple:!1}),a.on("select",(function(){const l=a.state().get("selection").first().toJSON();t.val(l.url),n.attr("src",l.url),i.show(),e(".radio-btn.selected").removeClass("selected"),o.hide(),s.hide()}))),a.open()})),e(document).on("click","#remove-image-btn",(function(e){e.preventDefault(),i.hide(),n.attr("src",""),t.val(""),o.show()}))},settings_page(){e(".color-picker").wpColorPicker()},submit_disabled_fields(){e("form").on("submit",(function(){e(this).find(":input").prop("disabled",!1)}))},ajax_get_children_list(){e(".parent_field select").change((function(){const t=e(this);let i="";const n=e(this).val();switch(e(this).attr("name")){case"course_id":i="course";break;case"lesson_id":i="lesson";break;case"topic_id":i="topic"}const o=e('select[name="course_id"]').val();e.ajax({url:ajaxurl,type:"POST",data:{action:"ld_achievements_get_children_list",course_id:o,parent_type:i,parent_id:n,nonce:LD_Achievements_Admin_Data.nonce}}).done((function(i){let n=i;n=JSON.parse(n),-1!==t.attr("name").indexOf("course")&&(e('select[name="topic_id"]').html("<option>"+LD_Achievements_Admin_Data.select_lesson_first+"</option>"),e('select[name="quiz_id"]').html("<option>"+LD_Achievements_Admin_Data.select_topic_first+"</option>"),e('select[name="lesson_id"]').html("<option>"+LD_Achievements_Admin_Data.select_lesson+'</option><option value="all">'+LD_Achievements_Admin_Data.all_lessons+"</option>"),e.each(n,(function(t,i){e('select[name="lesson_id"]').append('<option value="'+t+'">'+i+"</option>")}))),-1!==t.attr("name").indexOf("lesson")&&(e('select[name="quiz_id"]').html("<option>"+LD_Achievements_Admin_Data.select_topic_first+"</option>"),e('select[name="topic_id"]').html("<option>"+LD_Achievements_Admin_Data.select_topic+'</option><option value="all">'+LD_Achievements_Admin_Data.all_topics+"</option>"),e.each(n,(function(t,i){e('select[name="topic_id"]').append('<option value="'+t+'">'+i+"</option>")}))),-1!==t.attr("name").indexOf("topic")&&(e('select[name="quiz_id"]').html("<option>"+LD_Achievements_Admin_Data.select_quiz+'</option><option value="all">'+LD_Achievements_Admin_Data.all_quizzes+"</option>"),e.each(n,(function(t,i){e('select[name="quiz_id"]').append('<option value="'+t+'">'+i+"</option>")})))}))}))},update_select_values(){e('select[name="course_id"]').prop("selectedIndex",0),e('select[name="lesson_id"]').html("<option>"+LD_Achievements_Admin_Data.select_course_first+"</option>"),e('select[name="topic_id"]').html("<option>"+LD_Achievements_Admin_Data.select_lesson_first+"</option>"),e('select[name="quiz_id"]').html("<option>"+LD_Achievements_Admin_Data.select_topic_first+"</option>")},update_select_values_onload(){""===e('select[name="course_id"]').val()&&e('select[name="course_id"]').prop("selectedIndex",0),""===e('select[name="lesson_id"]').val()&&e('select[name="lesson_id"]').html("<option>"+LD_Achievements_Admin_Data.select_course_first+"</option>"),""===e('select[name="topic_id"]').val()&&e('select[name="topic_id"]').html("<option>"+LD_Achievements_Admin_Data.select_lesson_first+"</option>"),""===e('select[name="quiz_id"]').val()&&e('select[name="quiz_id"]').html("<option>"+LD_Achievements_Admin_Data.select_topic_first+"</option>")}},t.admin.init()}));