(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=jQuery;var n=e.n(t);const r=lodash,a=wp.hooks,o=wp.i18n,l=wp.components,m=wp.apiFetch;var c=e.n(m);const i=wp.element,s=window.rankMathComponents;function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,m=[],c=!0,i=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(m.push(r.value),m.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(i)throw a}}return m}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function e(t){n().ajax({url:ajaxurl,type:"GET",dataType:"html",data:{action:"csv_import_progress",_ajax_nonce:rankMath.csvProgressNonce}}).done((function(r){t({status:"processing",content:r}),n()(r).find("#csv-import-progress-value").length?setTimeout((function(){return e(t)}),3e3):t({status:"completed",content:r})}))};function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}const h=function(e){return wp.element.createElement(React.Fragment,null,wp.element.createElement("input",d({type:"checkbox"},e)),wp.element.createElement("label",{htmlFor:e.id},e.label))};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===y(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,m=[],c=!0,i=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(m.push(r.value),m.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(i)throw a}}return m}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=[{name:"rank-math-import-csv",title:wp.element.createElement(React.Fragment,null,wp.element.createElement("i",{className:"rm-icon rm-icon-import"}),wp.element.createElement("span",{className:"rank-math-tab-text"},(0,o.__)("Import CSV","rank-math"))),view:function(e){var t=e.data,n=p((0,i.useState)(!1),2),a=n[0],m=n[1],u=p((0,i.useState)(!0),2),d=u[0],h=u[1],y=p((0,i.useState)(t.importProgress),2),b=y[0],v=y[1];return(0,i.useEffect)((function(){(0,r.isEmpty)(b)||f(v)}),[]),wp.element.createElement("div",{id:"rank-math-import-form",className:"rank-math-import-csv-form field-form"},(0,r.isEmpty)(b)&&wp.element.createElement(React.Fragment,null,wp.element.createElement("div",null,wp.element.createElement("label",{htmlFor:"csv-import-me"},wp.element.createElement("strong",null,(0,o.__)("CSV File","rank-math-pro")))),wp.element.createElement("div",null,wp.element.createElement(l.FormFileUpload,{__next40pxDefaultSize:!0,accept:".csv",onChange:function(e){return m(e.currentTarget.files[0])}},wp.element.createElement("span",{className:"import-file-button"},(0,o.__)("Choose File","rank-math-pro")),a&&wp.element.createElement("span",null,a.name)),wp.element.createElement("br",null),wp.element.createElement("span",{className:"validation-message"},(0,o.__)("Please select a file to import.","rank-math-pro"))),wp.element.createElement("div",null,wp.element.createElement(s.CheckboxControl,{__nextHasNoMarginBottom:!0,label:(0,o.__)("Do not overwrite existing data","rank-math-pro"),help:(0,o.__)("Check this to import meta fields only if their current meta value is empty.","rank-math-pro"),checked:d,onChange:h})),a&&wp.element.createElement("div",null,wp.element.createElement(s.Notice,{status:"warning",className:"notice-connect-disabled"},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:(0,o.sprintf)((0,o.__)("%s It is recommended to save a database backup before using this option because importing malformed CSV can result in loss of data.","rank-math-pro"),"<strong>".concat((0,o.__)("Warning:","rank-math-pro"),"</strong>"))}})))),!(0,r.isEmpty)(b)&&wp.element.createElement("div",{id:"csv-import-progress-details"},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:b.content}})),wp.element.createElement("footer",null,(0,r.isEmpty)(b)&&wp.element.createElement(s.Button,{variant:"primary",disabled:!1===a,onClick:function(){if(confirm((0,o.__)("Are you sure you want to import meta data from this CSV file?","rank-math-pro"))){v({status:"processing",content:(0,o.__)("Import process has started, this may take a few moments to complete.","rank-math-pro")});var e=new FormData;e.append("csv-import-me",a),e.append("no_overwrite",d),c()({method:"POST",headers:{},path:"/rankmath/v1/importCSV",body:e}).catch((function(e){alert(e.message)})).then((function(e){m(!1),e.success?(v({status:"processing",content:e.message}),setTimeout((function(){return f(v)}),3e3)):alert(e.message)}))}}},(0,o.__)("Import","rank-math-pro")),!(0,r.isEmpty)(b)&&"completed"!==b.status&&wp.element.createElement(React.Fragment,null,wp.element.createElement(s.Button,{isDestructive:!0,className:"button-link-delete csv-import-cancel",onClick:function(){confirm((0,o.__)("Are you sure you want to stop the import process?","rank-math-pro"))&&c()({method:"POST",headers:{},path:"/rankmath/v1/cancelCsvImport"}).catch((function(e){alert(e.message)})).then((function(e){if("error"===e.type)return v({status:"error",content:e.message}),void setTimeout((function(){return f(v)}),3e3);v({})}))}},(0,o.__)("Cancel Import","rank-math-pro")),wp.element.createElement("span",{className:"input-loading"}))))}},{name:"rank-math-export-csv",title:wp.element.createElement(React.Fragment,null,wp.element.createElement("i",{className:"rm-icon rm-icon-export"}),wp.element.createElement("span",{className:"rank-math-tab-text"},(0,o.__)("Export CSV","rank-math"))),view:function(e){var t=e.data,n={post:(0,o.__)("Post types:","rank-math-pro"),term:(0,o.__)("Taxonomies:","rank-math-pro"),user:(0,o.__)("User Roles:","rank-math-pro")},a={post:(0,o.__)("Posts","rank-math-pro"),term:(0,o.__)("Terms","rank-math-pro"),user:(0,o.__)("Users","rank-math-pro")},l={post:"post_types",term:"taxonomies",user:"roles"},m=_((0,i.useState)(!1),2),c=m[0],p=m[1],u=_((0,i.useState)({post:Object.keys(t.exportData.post),term:Object.keys(t.exportData.term),user:Object.keys(t.exportData.user)}),2),f=u[0],d=u[1];return wp.element.createElement("form",{id:"csv-export-form",className:"rank-math-export-form field-form",action:"",method:"post"},wp.element.createElement("ul",null,(0,r.map)(t.exportData,(function(e,t){return wp.element.createElement("li",null,wp.element.createElement(h,{id:"object_type_"+t,label:a[t],name:"object_types[]",value:t,checked:!(0,r.isEmpty)(f[t]),onChange:function(n){f[t]=n.target.checked?Object.keys(e):[],d(v({},f))}}),c&&wp.element.createElement("div",{className:"csv-advanced-options"},wp.element.createElement("p",{className:"description"},n[t]),wp.element.createElement("ul",{className:"rank-math-checkbox-list"},(0,r.map)(e,(function(e,n){return wp.element.createElement("li",null,wp.element.createElement(h,{id:n,label:e,name:l[t]+"[]",value:n,checked:(0,r.includes)(f[t],n),onChange:function(e){e.target.checked?f[t].push(n):(0,r.pull)(f[t],n),d(v({},f))}}))})))))}))),wp.element.createElement("div",null,wp.element.createElement("p",{className:"description"},(0,o.__)("Choose the object types to export.","rank-math-pro")),wp.element.createElement(h,{id:"use-advanced-options",label:(0,o.__)("Use advanced options","rank-math-pro"),name:"use_advanced_options",value:!0,checked:c,onChange:p})),wp.element.createElement("footer",null,wp.element.createElement(s.TextControl,{type:"hidden",className:"hidden",name:"rank_math_pro_csv_export",value:"1"}),wp.element.createElement(s.TextControl,{type:"hidden",name:"_wpnonce",value:t.exportCsvNonce}),wp.element.createElement(s.Button,{variant:"primary",disabled:(0,r.isEmpty)(f),type:"submit"},(0,o.__)("Export","rank-math"))))}}];const k=function(e){return wp.element.createElement("div",{className:"import-export-csv"},wp.element.createElement("h2",null,(0,o.__)("CSV File","rank-math-pro")),wp.element.createElement("p",{className:"description"},(0,o.__)("Import SEO meta data for posts, terms, and users from a CSV file.","rank-math-pro")),wp.element.createElement("div",{className:"rank-math-box no-padding"},wp.element.createElement(l.TabPanel,{tabs:E},(function(t){var n=t.view;return wp.element.createElement("div",{className:"rank-math-box-content"},wp.element.createElement(n,{data:e.data}))}))))};function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,o=void 0,o=function(e,t){if("object"!==S(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===S(o)?o:String(o)),r)}var a,o}var O=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,a.addAction)("rank_math_pre_update_seo_score","rank-math-pro",this.applyContentBoundaries),(0,a.addFilter)("rank_math_update_score_researches_tests","rank-math-pro",this.researchesTests),(0,a.addFilter)("rank_math_status_import_export_tabs","rank-math-pro",(function(e,t){return wp.element.createElement(k,t)}))}var t,n,o;return t=e,(n=[{key:"applyContentBoundaries",value:function(e){(0,a.addFilter)("rankMath_analysis_contentLength_boundaries","rank-math-pro",(function(){return{recommended:{boundary:200,score:8},belowRecommended:{boundary:150,score:5},medium:{boundary:120,score:4},belowMedium:{boundary:100,score:3},low:{boundary:80,score:2}}}),11),e.isProduct||(0,a.removeAllFilters)("rankMath_analysis_contentLength_boundaries")}},{key:"researchesTests",value:function(e,t){return t.isProduct?((e=(0,r.difference)(e,["keywordInSubheadings","linksHasExternals","linksNotAllExternals","linksHasInternal","titleSentiment","titleHasNumber","contentHasTOC"])).push("hasProductSchema"),e.push("isReviewEnabled"),e):e}}])&&j(t.prototype,n),o&&j(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();n()((function(){new O}))})();