function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,r,s){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0===s)return("string"===r?String:Number)(e);s=s.call(e,r||"default");if("object"!=_typeof(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){var b=[].indexOf;jQuery(function(n){var r,s,t,_,i,m,e,o,a,c,p,d=null!=(l=window.wc_memberships_admin)?l:{},l=null!=(l=window.pagenow)?l:"";if("admin_page_wc_memberships_import_export"===l&&(n(".js-user-membership-date").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,showOn:"button",buttonImage:d.calendar_image,buttonImageOnly:!0}),s=n("#wc_memberships_members_csv_import_create_new_user_memberships"),c=n("#wc_memberships_members_csv_import_merge_existing_user_memberships"),r=n("#wc_memberships_members_csv_import_allow_memberships_transfer").closest("fieldset"),_=n("#wc_memberships_members_csv_import_create_new_users"),t=_.closest("fieldset"),a=n("#wc_memberships_members_csv_import_new_user_email_notification").closest("fieldset"),o=n("#wc_memberships_members_csv_import_default_start_date").closest("tr"),e=n("#wc_memberships_members_csv_import_date_format"),i=n("#wc_memberships_members_csv_import_custom_date_format").closest("tr"),s.on("change",function(e){return n(this).is(":checked")?(o.show(),t.show(),_.is(":checked")?a.show():a.hide()):(o.hide(),t.hide(),a.hide())}).trigger("change"),_.on("change",function(e){return n(this).is(":checked")&&s.is(":checked")?a.show():a.hide()}).trigger("change"),c.on("change",function(e){return n(this).is(":checked")?r.show():r.hide()}).trigger("change"),e.on("change",function(e){return"custom"===n(this).val()?i.show():i.hide()}).trigger("change"),c=n("#wc_memberships_members_csv_export_date_format"),m=n("#wc_memberships_members_csv_export_custom_date_format").closest("tr"),c.on("change",function(e){return"custom"===n(this).val()?m.show():m.hide()}).trigger("change")),"admin_page_wc_memberships_import_export"===l||"edit-wc_user_membership"===l||"wc_user_membership"===l)return n("button#wc-memberships-import-export-trigger").on("click",function(e){return e.preventDefault(),p(n(this).data("action-id"),n(this).data("action-title"))}),n("#doaction, #doaction2").on("click",function(e){return e.preventDefault(),"export"!==n(this).prev("select").val()||(e=n('input[type="checkbox"][name="post\\[\\]"]:checked').map(function(){return this.value}).get(),p("export",d.i18n.export_user_memberships,0===e.length?"undefined":e))}),p=function(r,s){var t,_,i,e,m,o,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];return"import"===r?(t=n("#wc-memberships-import-export-trigger"),_=t.next("span"),(e=0<(e=n("#wc_memberships_members_csv_import_file").prop("files")).length?e[0]:null)?(t.prop("disabled",!0),_.addClass("is-active"),(m=new FormData).append("action","wc_memberships_import_user_memberships"),m.append("security",d.import_user_memberships_nonce),m.append("file",e),m.append("create_new_memberships",n("#wc_memberships_members_csv_import_create_new_user_memberships").is(":checked")?"yes":"no"),m.append("merge_existing_memberships",n("#wc_memberships_members_csv_import_merge_existing_user_memberships").is(":checked")?"yes":"no"),m.append("allow_memberships_transfer",n("#wc_memberships_members_csv_import_allow_memberships_transfer").is(":checked")?"yes":"no"),m.append("create_new_users",n("#wc_memberships_members_csv_import_create_new_users").is(":checked")?"yes":"no"),m.append("notify_new_users",n("#wc_memberships_members_csv_import_new_user_email_notification").is(":checked")?"yes":"no"),m.append("date_format",n("#wc_memberships_members_csv_import_date_format").val()),m.append("custom_date_format",n("#wc_memberships_members_csv_import_custom_date_format").val()),m.append("timezone",n("#wc_memberships_members_csv_import_timezone").val()),m.append("default_start_date",n("#wc_memberships_members_csv_import_default_start_date").val()),m.append("fields_delimiter",n("#wc_memberships_members_csv_import_fields_delimiter").val()),o=["wc_memberships_members_csv_import_create_new_user_memberships","wc_memberships_members_csv_import_merge_existing_user_memberships","wc_memberships_members_csv_import_new_user_email_notification"],n("select, input, textarea").each(function(){var e=n(this).attr("id")||"",r=e.replace("wc_memberships_members_csv_import_","");if(r&&!m.has(r)&&b.call(o,e)<0)return"checkbox"===n(this).attr("type")?m.append(e,n(this).is(":checked")?"yes":"no"):m.append(e,n(this).val())}),n.ajax({url:d.ajax_url,type:"POST",data:m,contentType:!1,processData:!1,success:function(e){return t.prop("disabled",!1),_.removeClass("is-active"),new WC_Memberships_Modal_Import_Export_User_Memberships({data:{job:e.success&&e.data?e.data:{},error:!e.success&&e.data?e.data:null,action:{id:r,title:s}}})},error:function(e){return t.prop("disabled",!1),_.removeClass("is-active"),new WC_Memberships_Modal_Import_Export_User_Memberships({data:{job:null,error:e.data||null,action:{id:r,title:s}}})}})):alert(d.i18n.import_file_missing)):"export"===r?(i={action:"wc_memberships_export_user_memberships",security:d.export_user_memberships_nonce,export_params:{user_membership_ids:a,plan_ids:n("#wc_memberships_members_csv_export_plan").val(),plan_statuses:n("#wc_memberships_members_csv_export_status").val(),start_date_from:n("#wc_memberships_members_csv_export_start_date_from").val(),start_date_to:n("#wc_memberships_members_csv_export_start_date_to").val(),end_date_from:n("#wc_memberships_members_csv_export_end_date_from").val(),end_date_to:n("#wc_memberships_members_csv_export_end_date_to").val(),date_format:n("#wc_memberships_members_csv_export_date_format").val(),custom_date_format:n("#wc_memberships_members_csv_export_custom_date_format").val(),fields_delimiter:n("#wc_memberships_members_csv_export_fields_delimiter").val(),include_profile_fields:n("#wc_memberships_members_csv_export_profile_fields").is(":checked")?"yes":"no",include_meta:n("#wc_memberships_members_csv_export_meta_data").is(":checked")?"yes":"no"}},o=["wc_memberships_members_csv_export_plan","wc_memberships_members_csv_export_status","wc_memberships_members_csv_export_profile_fields","wc_memberships_members_csv_export_meta_data"],n("select, input, textarea").each(function(){var e=n(this).attr("id")||"",r=e.replace("wc_memberships_members_csv_export_","");if(r&&b.call(i.export_params,r)<0&&b.call(o,e)<0)return"checkbox"===n(this).attr("type")?n.extend(i.export_params,_defineProperty({},"".concat(r),n(this).is(":checked")?"yes":"no")):n.extend(i.export_params,_defineProperty({},"".concat(r),n(this).val()))}),n.post(d.ajax_url,i,function(e){return e.data?new WC_Memberships_Modal_Import_Export_User_Memberships({data:{job:e.success?e.data:null,error:e.success?null:e.data,action:{id:r,title:s}}}):console.log(e)})):void 0},window.WC_Memberships_Modal_Import_Export_User_Memberships=WC_Memberships_Modal_View.extend({template_id:"wc-memberships-modal-import-export-user-memberships",initialize:function(e){var r=this,s=e.data.action,t=e.data.job||null,_=e.data.error||null;if(WC_Memberships_Modal_Import_Export_User_Memberships.__super__.initialize.apply(this,[e]),n("#wc-memberships-modal-import-export-user-memberships").find("h1").text(s.title),r.unblock(),_&&(window.onbeforeunload=null),t)return window.onbeforeunload=function(){return"export"===s.id?d.i18n.confirm_export_cancel:"import"===s.id?d.i18n.confirm_import_cancel:void 0},"completed"!==t.status?(e={action:"wc_memberships_get_batch_job",security:d.get_memberships_batch_job_nonce,job_name:t.name,job_id:t.id,process:!0},n.post(d.ajax_url,e,function(e){return e.data?(r.close(),new WC_Memberships_Modal_Import_Export_User_Memberships({data:{job:e.success?e.data:null,error:e.success?null:e.data,action:{id:s.id,title:s.title}}})):console.log(e)})):(window.onbeforeunload=null,"export"===s.id&&0<parseInt(t.results.exported,10)&&t.download_url?window.location.href=t.download_url:void 0)}})})}.call(void 0);//# sourceMappingURL=wc-memberships-import-export.min.js.map